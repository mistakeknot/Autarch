#!/usr/bin/env bash
set -euo pipefail

cd "$(dirname "$0")"

usage() {
    echo "Usage: ./dev <tool> [args...]"
    echo ""
    echo "Tools:"
    echo "  vauxhall     - Build and run Vauxhall (mission control)"
    echo "  pollard      - Build and run Pollard (research intelligence)"
    echo "  praude       - Build and run Praude (PRD generation)"
    echo "  tandemonium  - Build and run Tandemonium (task tracker)"
    echo ""
    echo "Examples:"
    echo "  ./dev vauxhall --tui       # TUI mode"
    echo "  ./dev vauxhall --daemon    # Daemon mode (schmux-style)"
    echo "  ./dev pollard init         # Initialize Pollard in project"
    echo "  ./dev pollard scan         # Run research agents"
    echo "  ./dev praude list          # List PRDs/specs"
    echo "  ./dev tandemonium status   # Show task status"
    exit 1
}

if [ $# -lt 1 ]; then
    usage
fi

TOOL="$1"
shift

case "$TOOL" in
    vauxhall)
        go build -o vauxhall ./cmd/vauxhall
        exec ./vauxhall "$@"
        ;;
    pollard)
        go build -o pollard ./cmd/pollard
        exec ./pollard "$@"
        ;;
    praude)
        go build -o praude ./cmd/praude
        exec ./praude "$@"
        ;;
    tandemonium)
        go build -o tandemonium ./cmd/tandemonium
        exec ./tandemonium "$@"
        ;;
    *)
        echo "Unknown tool: $TOOL"
        usage
        ;;
esac
